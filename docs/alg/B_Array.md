# 数组和排序类问题

## 二分法、二分查找

### 局部最小值问题 Code001

**问题描述**

定义何为局部最小值：

- arr[0] < arr[1]，0位置是局部最小；
- arr[N-1] < arr[N-2]，N-1位置是局部最小；
- arr[i-1] > arr[i] < arr[i+1]，i位置是局部最小；

给定一个数组arr，已知任何两个相邻的数都不相等，找到随便一个局部最小位置返回

## 归并排序

### 小和问题 Code002

**问题描述**
在一个数组中，一个数左边比它小的数的总和，叫该数的小和。所有数的小和累加起来，叫数组小和
> 例子： [1,3,4,2,5]
> + 1左边比1小的数：没有
> + 3左边比3小的数：1
> + 4左边比4小的数：1、3
> + 2左边比2小的数：1
> + 5左边比5小的数：1、3、4、 2
> + 所以数组的小和为1+1+3+1+1+3+4+2=16

给定一个数组arr，求数组小和

**思路**

- 归并排序，merge 的时候判断右边的数是否比左边的数大，如果大，则计算数组的小和
- merge 之前，左边数组 arr[l...mid] 和右边数组 arr[mid+1...r] 都是从小到大排好序的
- merge 时，从小到大遍历，如果左边的数 arr[p1] 比右边的数 arr[p2] 小，则左边的这个数 arr[p1] 比右边剩下的所有的数 arr[p2...r] 都小， 所以数组的小和需要加上  (r - p2 + 1)
  *arr[p1]
- merge 时，合并数组到 help，相等的情况一定要先将右边的方到 help 数组中

### 降序对个数 Code003

**问题描述**
在一个数组中，任何一个前面的数a，和任何一个后面的数b，如果(a,b)是降序的，就称为降序对 给定一个数组arr，求数组的降序对总数量

**思路**

- 归并排序，merge 的时候判断左边的数是否比右边的数大，如果大，则计数
- merge 之前，左边数组 arr[l...mid] 和右边数组 arr[mid+1...r] 都是从小到大排好序的
- merge 时，**从大到小遍历**，如果左边的数 arr[p1] 比右边的数 arr[p2] 大，则左边的这个数 arr[p1] 比右边剩下的所有的数 arr[mid+1...p2] 都大， 所以降序对个数需要加上 (p2-mid)
- merge 时，合并数组到 help，相等的情况一定要先将右边的方到 help 数组中

### 翻转对 Code004

**问题描述**

- [leetcode](https://leetcode.com/problems/reverse-pairs/)
- 你需要返回给定数组中的翻转对的数量。
- 给定一个数组nums， 如果 i < j 且 nums[i] > 2*nums[j] 我们就将(i, j)称作一个重要翻转对。

**思路**

- merge 的时候，对左边的数组 arr[l...mid] 遍历，找到 arr[i] 在右边数组 arr[mid+1...r] 中第一个满足条件的数 arr[w]
- 那么 arr[i] 对于 arr[w...r] 都满足 arr[i] > 2*arr[j]，则 翻转对个数 + （r - w）

### 区间和个数 Code005

**题目描述**

- [leetcode](https://leetcode.com/problems/count-of-range-sum/)
- 给定一个数组arr，两个整数lower和upper，返回arr中有多少个子数组的累加和在[lower,upper]范围上

**思路**

- 计算数组 arr[] 的前缀和数组 sum[]，对前缀和数组归并排序
- merge的时候，遍历右边的数组 sum[mid+1...r]，找到左边数组 sum[l...mid] 中满足条件的子数组 sum[wl...wr]
    - 满足条件 lower <= sum[i] - sum[j] <= upper，其中 mid+1 <= i <= r; l <= j <= mid
    - lower <= sum[i] - sum[j] <= upper 表示数组 arr[] 的子数组 arr[j...i] 满足累加和在[lower,upper]范围上
    - sum[i] - upper <= sum[j] <= sum[i] - lower，找到满足条件的 sum[wl...wr]
    - 那么可以得到，arr 中以 i 为结尾的子数组中，一共有（wr - wl）个满足累加和在[lower,upper]范围上

## 堆结构&堆排序

### 几乎有序数组排序 Code006

**题目描述**
已知一个几乎有序的数组。几乎有序是指，如果把数组排好顺序的话，每个元素移动的距离一定不超过k；k相对于数组长度来说是比较小的。请选择一个合适的排序策略，对这个数组进行排序。

**思路**

- 维护长度为 k 的小根堆，arr[] 前 k-1 个元素先进堆
- 然后 arr[] 中元素进堆一个元素，从堆中获取一个元素放到 arr[idx-k] 上
- 最后把堆中剩余的元素依次出堆，放到 arr[] 对应位置上

### 最大重叠线段(最少需要的会议室个数) Code007

**题目描述**

- [leetcode](https://leetcode.cn/problems/meeting-rooms-ii/submissions/)
- 给定很多线段，每个线段都有两个数[start, end]， 表示线段开始位置和结束位置，左右都是闭区间。规定：
    - 1）线段的开始和结束位置一定都是整数值
    - 2）线段重合区域的长度必须>=1 返回线段最多重合区域中，包含了几条线段

**思路**

- 根据开始时间排序
- 遍历排序好的数组，将结束时间放入小根堆，并判断小根堆里的有多少个结束时间大于本次的开始时间



